"use strict";(()=>{var e={};e.id=976,e.ids=[976],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6005:e=>{e.exports=require("node:crypto")},4448:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>w});var o={};r.r(o),r.d(o,{GET:()=>u,PATCH:()=>l});var i=r(5419),n=r(9108),s=r(9678),a=r(8070),d=r(156);async function u(e){let{searchParams:t}=new URL(e.url),r=t.get("code");if(!r)return a.Z.json({error:"Code required"},{status:400});let o=await d.T.get(`dropcode:${r}`);if(!o)return a.Z.json({error:"File not found or expired"},{status:404});let i=o.files&&o.files.length>0?o.files[0].mimeType:"application/octet-stream";return a.Z.json({code:o.code,originalName:o.originalName,size:o.size,mimeType:i,expiresAt:o.expiresAt,fileCount:o.files.length,expiryMinutes:o.expiryMinutes,maxDownloads:o.maxDownloads===1/0?"Unlimited":o.maxDownloads,downloads:o.downloads})}async function l(e){try{let{code:t,expiryMinutes:r,maxDownloads:o}=await e.json();if(!t)return a.Z.json({error:"Code required"},{status:400});let i=await d.T.get(`dropcode:${t}`);if(!i)return a.Z.json({error:"File not found or expired"},{status:404});if(void 0!==r){let e=parseInt(r);[5,10,30].includes(e)&&(i.expiryMinutes=e)}if(void 0!==o){if("Infinity"===o||null===o)i.maxDownloads=1/0;else{let e=parseInt(o);i.maxDownloads=e}}return await d.T.set(`dropcode:${t}`,i,{ex:600}),a.Z.json({code:i.code,expiresAt:i.expiresAt,expiryMinutes:i.expiryMinutes,maxDownloads:i.maxDownloads===1/0?"Unlimited":i.maxDownloads,downloads:i.downloads})}catch(e){return a.Z.json({error:"Invalid request"},{status:400})}}let p=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/verify/route",pathname:"/api/verify",filename:"route",bundlePath:"app/api/verify/route"},resolvedPagePath:"X:\\projects\\DropCode\\app\\api\\verify\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:x,serverHooks:m,headerHooks:f,staticGenerationBailout:w}=p,y="/api/verify/route";function v(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:x})}},156:(e,t,r)=>{r.d(t,{T:()=>o});let o=new(r(9125)).s({url:process.env.UPSTASH_REDIS_REST_URL||"https://example.upstash.io",token:process.env.UPSTASH_REDIS_REST_TOKEN||"example_token"})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,206,125],()=>r(4448));module.exports=o})();