"use strict";(()=>{var e={};e.id=381,e.ids=[381],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6005:e=>{e.exports=require("node:crypto")},1610:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>v,patchFetch:()=>S,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>m});var o={};t.r(o),t.d(o,{GET:()=>d});var a=t(5419),s=t(9108),n=t(9678),i=t(8070);let u=new(t(9125)).s({url:process.env.UPSTASH_REDIS_REST_URL,token:process.env.UPSTASH_REDIS_REST_TOKEN});async function d(e,{params:r}){let{code:t}=r;if(!t)return i.Z.json({error:"Code required"},{status:400});try{let e=await u.get(`share:${t}`);if(!e)return i.Z.json({error:"File not found or expired"},{status:404});if(e.downloadsLeft<=0)return i.Z.json({error:"Download limit reached"},{status:410});return i.Z.json({code:e.shareCode,originalName:e.originalName,size:e.files.reduce((e,r)=>e+r.size,0),downloadsLeft:e.downloadsLeft,expiresAt:e.expiresAt,fileCount:e.files.length})}catch(e){return console.error("Metadata fetch error:",e),i.Z.json({error:"Internal Server Error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/share/[code]/route",pathname:"/api/share/[code]",filename:"route",bundlePath:"app/api/share/[code]/route"},resolvedPagePath:"X:\\projects\\DropCode\\app\\api\\share\\[code]\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:h,headerHooks:f,staticGenerationBailout:m}=p,v="/api/share/[code]/route";function S(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:l})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[638,206,125],()=>t(1610));module.exports=o})();