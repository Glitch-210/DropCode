"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/share/[code]/download/route";
exports.ids = ["app/api/share/[code]/download/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&page=%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute.ts&appDir=X%3A%5Cprojects%5CDropCode%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=X%3A%5Cprojects%5CDropCode&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&page=%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute.ts&appDir=X%3A%5Cprojects%5CDropCode%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=X%3A%5Cprojects%5CDropCode&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var X_projects_DropCode_app_api_share_code_download_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/share/[code]/download/route.ts */ \"(rsc)/./app/api/share/[code]/download/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/share/[code]/download/route\",\n        pathname: \"/api/share/[code]/download\",\n        filename: \"route\",\n        bundlePath: \"app/api/share/[code]/download/route\"\n    },\n    resolvedPagePath: \"X:\\\\projects\\\\DropCode\\\\app\\\\api\\\\share\\\\[code]\\\\download\\\\route.ts\",\n    nextConfigOutput,\n    userland: X_projects_DropCode_app_api_share_code_download_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/share/[code]/download/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzaGFyZSUyRiU1QmNvZGUlNUQlMkZkb3dubG9hZCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGc2hhcmUlMkYlNUJjb2RlJTVEJTJGZG93bmxvYWQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZzaGFyZSUyRiU1QmNvZGUlNUQlMkZkb3dubG9hZCUyRnJvdXRlLnRzJmFwcERpcj1YJTNBJTVDcHJvamVjdHMlNUNEcm9wQ29kZSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9WCUzQSU1Q3Byb2plY3RzJTVDRHJvcENvZGUmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDbUI7QUFDaEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcm9wY29kZS8/NzQzMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJYOlxcXFxwcm9qZWN0c1xcXFxEcm9wQ29kZVxcXFxhcHBcXFxcYXBpXFxcXHNoYXJlXFxcXFtjb2RlXVxcXFxkb3dubG9hZFxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc2hhcmUvW2NvZGVdL2Rvd25sb2FkL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc2hhcmUvW2NvZGVdL2Rvd25sb2FkXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zaGFyZS9bY29kZV0vZG93bmxvYWQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJYOlxcXFxwcm9qZWN0c1xcXFxEcm9wQ29kZVxcXFxhcHBcXFxcYXBpXFxcXHNoYXJlXFxcXFtjb2RlXVxcXFxkb3dubG9hZFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zaGFyZS9bY29kZV0vZG93bmxvYWQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&page=%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute.ts&appDir=X%3A%5Cprojects%5CDropCode%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=X%3A%5Cprojects%5CDropCode&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/share/[code]/download/route.ts":
/*!************************************************!*\
  !*** ./app/api/share/[code]/download/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _upstash_redis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @upstash/redis */ \"(rsc)/./node_modules/@upstash/redis/nodejs.mjs\");\n\n\nconst redis = new _upstash_redis__WEBPACK_IMPORTED_MODULE_1__.Redis({\n    url: process.env.UPSTASH_REDIS_REST_URL,\n    token: process.env.UPSTASH_REDIS_REST_TOKEN\n});\nasync function POST(request, { params }) {\n    const { code } = params;\n    if (!code) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Code required\"\n        }, {\n            status: 400\n        });\n    }\n    try {\n        // Lua script to atomically check and decrement\n        // Keys: share:{code}\n        // Args: none\n        // Returns: metadata (json) if allowed, nil or error if not\n        // For simplicity with Upstash HTTP, we might do GET + SET/DECR, but race conditions exist.\n        // Better: DECR downloadsLeft. If < 0, increment back?\n        // Or just simple GET, Check, DECR.\n        const key = `share:${code}`;\n        const metadata = await redis.get(key);\n        if (!metadata) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"File not found or expired\"\n            }, {\n                status: 404\n            });\n        }\n        if (metadata.downloadsLeft <= 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Download limit reached\"\n            }, {\n                status: 410\n            });\n        }\n        // Decrement\n        metadata.downloadsLeft -= 1;\n        metadata.downloads += 1; // Track total\n        // If 0, we can delete the key OR keep it with 0 to show \"Expired\" message.\n        // Plan says \"If downloadsLeft === 0, delete Redis key and trigger blob cleanup\".\n        // Let's delete if 0, so subsequent requests 404.\n        if (metadata.downloadsLeft <= 0) {\n            await redis.del(key);\n        // Trigger background cleanup (Phase 5) - for now just delete metadata\n        } else {\n            // Update metadata\n            // Use KEEPTTL to preserve expiry\n            await redis.set(key, metadata, {\n                keepTtl: true\n            });\n        }\n        // Return Blob URLs\n        // If multiple files, client handles downloading them?\n        // Current UI seems to support single URL redirect `window.location.href = data.url`.\n        // If multiple files, we should probably ZIP them if we could, but we can't easily.\n        // Or return the first one?\n        // DropCode seems to handle folders as \"dropcode-files\".\n        // If we have multiple blobs, maybe we return the list and client downloads all?\n        // `DownloadingState.tsx` checks `data.url`.\n        // Quick fix for MVP: If 1 file, return that URL. \n        // If multiple, implementation plan says \"Support folder uploads\".\n        let downloadUrl = metadata.files[0].url;\n        // If multiple files, we need a way to download all.\n        // For now, let's just return the first one or valid list.\n        // Ideally we'd loop.\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            url: downloadUrl,\n            files: metadata.files // Send all just in case client updates to support multi\n        });\n    } catch (error) {\n        console.error(\"Download claim error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal Server Error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3NoYXJlL1tjb2RlXS9kb3dubG9hZC9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMkM7QUFDSjtBQUV2QyxNQUFNRSxRQUFRLElBQUlELGlEQUFLQSxDQUFDO0lBQ3BCRSxLQUFLQyxRQUFRQyxHQUFHLENBQUNDLHNCQUFzQjtJQUN2Q0MsT0FBT0gsUUFBUUMsR0FBRyxDQUFDRyx3QkFBd0I7QUFDL0M7QUFFTyxlQUFlQyxLQUFLQyxPQUFnQixFQUFFLEVBQUVDLE1BQU0sRUFBZ0M7SUFDakYsTUFBTSxFQUFFQyxJQUFJLEVBQUUsR0FBR0Q7SUFFakIsSUFBSSxDQUFDQyxNQUFNO1FBQ1AsT0FBT1osa0ZBQVlBLENBQUNhLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQWdCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ3ZFO0lBRUEsSUFBSTtRQUNBLCtDQUErQztRQUMvQyxxQkFBcUI7UUFDckIsYUFBYTtRQUNiLDJEQUEyRDtRQUUzRCwyRkFBMkY7UUFDM0Ysc0RBQXNEO1FBQ3RELG1DQUFtQztRQUVuQyxNQUFNQyxNQUFNLENBQUMsTUFBTSxFQUFFSixLQUFLLENBQUM7UUFDM0IsTUFBTUssV0FBZ0IsTUFBTWYsTUFBTWdCLEdBQUcsQ0FBQ0Y7UUFFdEMsSUFBSSxDQUFDQyxVQUFVO1lBQ1gsT0FBT2pCLGtGQUFZQSxDQUFDYSxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBNEIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ25GO1FBRUEsSUFBSUUsU0FBU0UsYUFBYSxJQUFJLEdBQUc7WUFDN0IsT0FBT25CLGtGQUFZQSxDQUFDYSxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBeUIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ2hGO1FBRUEsWUFBWTtRQUNaRSxTQUFTRSxhQUFhLElBQUk7UUFDMUJGLFNBQVNHLFNBQVMsSUFBSSxHQUFHLGNBQWM7UUFFdkMsMkVBQTJFO1FBQzNFLGlGQUFpRjtRQUNqRixpREFBaUQ7UUFFakQsSUFBSUgsU0FBU0UsYUFBYSxJQUFJLEdBQUc7WUFDN0IsTUFBTWpCLE1BQU1tQixHQUFHLENBQUNMO1FBQ2hCLHNFQUFzRTtRQUMxRSxPQUFPO1lBQ0gsa0JBQWtCO1lBQ2xCLGlDQUFpQztZQUNqQyxNQUFNZCxNQUFNb0IsR0FBRyxDQUFDTixLQUFLQyxVQUFVO2dCQUFFTSxTQUFTO1lBQUs7UUFDbkQ7UUFFQSxtQkFBbUI7UUFDbkIsc0RBQXNEO1FBQ3RELHFGQUFxRjtRQUNyRixtRkFBbUY7UUFDbkYsMkJBQTJCO1FBQzNCLHdEQUF3RDtRQUN4RCxnRkFBZ0Y7UUFDaEYsNENBQTRDO1FBRTVDLGtEQUFrRDtRQUNsRCxrRUFBa0U7UUFFbEUsSUFBSUMsY0FBY1AsU0FBU1EsS0FBSyxDQUFDLEVBQUUsQ0FBQ3RCLEdBQUc7UUFFdkMsb0RBQW9EO1FBQ3BELDBEQUEwRDtRQUMxRCxxQkFBcUI7UUFFckIsT0FBT0gsa0ZBQVlBLENBQUNhLElBQUksQ0FBQztZQUNyQlYsS0FBS3FCO1lBQ0xDLE9BQU9SLFNBQVNRLEtBQUssQ0FBQyx3REFBd0Q7UUFDbEY7SUFFSixFQUFFLE9BQU9YLE9BQU87UUFDWlksUUFBUVosS0FBSyxDQUFDLHlCQUF5QkE7UUFDdkMsT0FBT2Qsa0ZBQVlBLENBQUNhLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXdCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQy9FO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcm9wY29kZS8uL2FwcC9hcGkvc2hhcmUvW2NvZGVdL2Rvd25sb2FkL3JvdXRlLnRzP2I2OGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBSZWRpcyB9IGZyb20gJ0B1cHN0YXNoL3JlZGlzJztcclxuXHJcbmNvbnN0IHJlZGlzID0gbmV3IFJlZGlzKHtcclxuICAgIHVybDogcHJvY2Vzcy5lbnYuVVBTVEFTSF9SRURJU19SRVNUX1VSTCEsXHJcbiAgICB0b2tlbjogcHJvY2Vzcy5lbnYuVVBTVEFTSF9SRURJU19SRVNUX1RPS0VOISxcclxufSk7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0LCB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBjb2RlOiBzdHJpbmcgfSB9KSB7XHJcbiAgICBjb25zdCB7IGNvZGUgfSA9IHBhcmFtcztcclxuXHJcbiAgICBpZiAoIWNvZGUpIHtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0NvZGUgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgICAvLyBMdWEgc2NyaXB0IHRvIGF0b21pY2FsbHkgY2hlY2sgYW5kIGRlY3JlbWVudFxyXG4gICAgICAgIC8vIEtleXM6IHNoYXJlOntjb2RlfVxyXG4gICAgICAgIC8vIEFyZ3M6IG5vbmVcclxuICAgICAgICAvLyBSZXR1cm5zOiBtZXRhZGF0YSAoanNvbikgaWYgYWxsb3dlZCwgbmlsIG9yIGVycm9yIGlmIG5vdFxyXG5cclxuICAgICAgICAvLyBGb3Igc2ltcGxpY2l0eSB3aXRoIFVwc3Rhc2ggSFRUUCwgd2UgbWlnaHQgZG8gR0VUICsgU0VUL0RFQ1IsIGJ1dCByYWNlIGNvbmRpdGlvbnMgZXhpc3QuXHJcbiAgICAgICAgLy8gQmV0dGVyOiBERUNSIGRvd25sb2Fkc0xlZnQuIElmIDwgMCwgaW5jcmVtZW50IGJhY2s/XHJcbiAgICAgICAgLy8gT3IganVzdCBzaW1wbGUgR0VULCBDaGVjaywgREVDUi5cclxuXHJcbiAgICAgICAgY29uc3Qga2V5ID0gYHNoYXJlOiR7Y29kZX1gO1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhOiBhbnkgPSBhd2FpdCByZWRpcy5nZXQoa2V5KTtcclxuXHJcbiAgICAgICAgaWYgKCFtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ZpbGUgbm90IGZvdW5kIG9yIGV4cGlyZWQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobWV0YWRhdGEuZG93bmxvYWRzTGVmdCA8PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRG93bmxvYWQgbGltaXQgcmVhY2hlZCcgfSwgeyBzdGF0dXM6IDQxMCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIERlY3JlbWVudFxyXG4gICAgICAgIG1ldGFkYXRhLmRvd25sb2Fkc0xlZnQgLT0gMTtcclxuICAgICAgICBtZXRhZGF0YS5kb3dubG9hZHMgKz0gMTsgLy8gVHJhY2sgdG90YWxcclxuXHJcbiAgICAgICAgLy8gSWYgMCwgd2UgY2FuIGRlbGV0ZSB0aGUga2V5IE9SIGtlZXAgaXQgd2l0aCAwIHRvIHNob3cgXCJFeHBpcmVkXCIgbWVzc2FnZS5cclxuICAgICAgICAvLyBQbGFuIHNheXMgXCJJZiBkb3dubG9hZHNMZWZ0ID09PSAwLCBkZWxldGUgUmVkaXMga2V5IGFuZCB0cmlnZ2VyIGJsb2IgY2xlYW51cFwiLlxyXG4gICAgICAgIC8vIExldCdzIGRlbGV0ZSBpZiAwLCBzbyBzdWJzZXF1ZW50IHJlcXVlc3RzIDQwNC5cclxuXHJcbiAgICAgICAgaWYgKG1ldGFkYXRhLmRvd25sb2Fkc0xlZnQgPD0gMCkge1xyXG4gICAgICAgICAgICBhd2FpdCByZWRpcy5kZWwoa2V5KTtcclxuICAgICAgICAgICAgLy8gVHJpZ2dlciBiYWNrZ3JvdW5kIGNsZWFudXAgKFBoYXNlIDUpIC0gZm9yIG5vdyBqdXN0IGRlbGV0ZSBtZXRhZGF0YVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBtZXRhZGF0YVxyXG4gICAgICAgICAgICAvLyBVc2UgS0VFUFRUTCB0byBwcmVzZXJ2ZSBleHBpcnlcclxuICAgICAgICAgICAgYXdhaXQgcmVkaXMuc2V0KGtleSwgbWV0YWRhdGEsIHsga2VlcFR0bDogdHJ1ZSB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJldHVybiBCbG9iIFVSTHNcclxuICAgICAgICAvLyBJZiBtdWx0aXBsZSBmaWxlcywgY2xpZW50IGhhbmRsZXMgZG93bmxvYWRpbmcgdGhlbT9cclxuICAgICAgICAvLyBDdXJyZW50IFVJIHNlZW1zIHRvIHN1cHBvcnQgc2luZ2xlIFVSTCByZWRpcmVjdCBgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBkYXRhLnVybGAuXHJcbiAgICAgICAgLy8gSWYgbXVsdGlwbGUgZmlsZXMsIHdlIHNob3VsZCBwcm9iYWJseSBaSVAgdGhlbSBpZiB3ZSBjb3VsZCwgYnV0IHdlIGNhbid0IGVhc2lseS5cclxuICAgICAgICAvLyBPciByZXR1cm4gdGhlIGZpcnN0IG9uZT9cclxuICAgICAgICAvLyBEcm9wQ29kZSBzZWVtcyB0byBoYW5kbGUgZm9sZGVycyBhcyBcImRyb3Bjb2RlLWZpbGVzXCIuXHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBtdWx0aXBsZSBibG9icywgbWF5YmUgd2UgcmV0dXJuIHRoZSBsaXN0IGFuZCBjbGllbnQgZG93bmxvYWRzIGFsbD9cclxuICAgICAgICAvLyBgRG93bmxvYWRpbmdTdGF0ZS50c3hgIGNoZWNrcyBgZGF0YS51cmxgLlxyXG5cclxuICAgICAgICAvLyBRdWljayBmaXggZm9yIE1WUDogSWYgMSBmaWxlLCByZXR1cm4gdGhhdCBVUkwuIFxyXG4gICAgICAgIC8vIElmIG11bHRpcGxlLCBpbXBsZW1lbnRhdGlvbiBwbGFuIHNheXMgXCJTdXBwb3J0IGZvbGRlciB1cGxvYWRzXCIuXHJcblxyXG4gICAgICAgIGxldCBkb3dubG9hZFVybCA9IG1ldGFkYXRhLmZpbGVzWzBdLnVybDtcclxuXHJcbiAgICAgICAgLy8gSWYgbXVsdGlwbGUgZmlsZXMsIHdlIG5lZWQgYSB3YXkgdG8gZG93bmxvYWQgYWxsLlxyXG4gICAgICAgIC8vIEZvciBub3csIGxldCdzIGp1c3QgcmV0dXJuIHRoZSBmaXJzdCBvbmUgb3IgdmFsaWQgbGlzdC5cclxuICAgICAgICAvLyBJZGVhbGx5IHdlJ2QgbG9vcC5cclxuXHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICAgICAgdXJsOiBkb3dubG9hZFVybCxcclxuICAgICAgICAgICAgZmlsZXM6IG1ldGFkYXRhLmZpbGVzIC8vIFNlbmQgYWxsIGp1c3QgaW4gY2FzZSBjbGllbnQgdXBkYXRlcyB0byBzdXBwb3J0IG11bHRpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdEb3dubG9hZCBjbGFpbSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH0sIHsgc3RhdHVzOiA1MDAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIlJlZGlzIiwicmVkaXMiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiVVBTVEFTSF9SRURJU19SRVNUX1VSTCIsInRva2VuIiwiVVBTVEFTSF9SRURJU19SRVNUX1RPS0VOIiwiUE9TVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJjb2RlIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwia2V5IiwibWV0YWRhdGEiLCJnZXQiLCJkb3dubG9hZHNMZWZ0IiwiZG93bmxvYWRzIiwiZGVsIiwic2V0Iiwia2VlcFR0bCIsImRvd25sb2FkVXJsIiwiZmlsZXMiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/share/[code]/download/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@upstash","vendor-chunks/uncrypto"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&page=%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fshare%2F%5Bcode%5D%2Fdownload%2Froute.ts&appDir=X%3A%5Cprojects%5CDropCode%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=X%3A%5Cprojects%5CDropCode&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();