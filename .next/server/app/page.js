(()=>{var e={};e.id=931,e.ids=[931],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5984:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=r(482),a=r(9108),n=r(2563),o=r.n(n),l=r(8300),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);r.d(t,i);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1450)),"X:\\projects\\DropCode\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2917)),"X:\\projects\\DropCode\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],c=["X:\\projects\\DropCode\\app\\page.tsx"],p="/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2176:()=>{},6214:(e,t,r)=>{Promise.resolve().then(r.bind(r,6525)),Promise.resolve().then(r.bind(r,3643))},3213:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},6525:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(5344),a=r(3643),n=r(3729);let o="/api",l=async(e,t)=>{let r=new FormData;(e instanceof FileList?Array.from(e):e).forEach(e=>{r.append("files",e)});let s=new XMLHttpRequest;return new Promise((e,a)=>{s.upload.addEventListener("progress",e=>{e.lengthComputable&&t&&t(Math.round(100*e.loaded/e.total))}),s.addEventListener("load",()=>{if(s.status>=200&&s.status<300)try{let t=JSON.parse(s.responseText);e(t)}catch(e){a({error:"Invalid response"})}else try{let e=JSON.parse(s.responseText);a(e)}catch(e){a({error:"Upload failed"})}}),s.addEventListener("error",()=>{a({error:"Network Error"})}),s.addEventListener("abort",()=>{a({error:"Upload Cancelled"})}),s.open("POST",`${o}/upload`),s.send(r)})},i=async e=>{let t=await fetch(`${o}/verify?code=${encodeURIComponent(e)}`),r=await t.json();if(!t.ok)throw r;return r},d=async(e,t)=>{let r=await fetch(`${o}/verify`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e,...t})}),s=await r.json();if(!r.ok)throw s;return s},c=e=>`${o}/download?code=${encodeURIComponent(e)}`;function p(){let{startUpload:e,setProgress:t,uploadSuccess:r,uploadError:o}=(0,a.useApp)(),[i,d]=(0,n.useState)(!1),c=(0,n.useRef)(null),p=async s=>{if(!s||0===s.length)return;let a=0,n=s instanceof FileList?Array.from(s):s;for(let e of n)a+=e.size;if(a>209715200){alert("Total size too large (Max 200MB)");return}e();try{let e=await l(n,e=>{t(e)});setTimeout(()=>{r(e)},300)}catch(e){console.error(e),o(e.error||"Upload failed")}};return(0,s.jsxs)("div",{className:`brutal-upload-zone ${i?"dragover":""}`,onDrop:e=>{e.preventDefault(),d(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&p(e.dataTransfer.files)},onDragOver:e=>{e.preventDefault(),d(!0)},onDragLeave:()=>{d(!1)},onClick:()=>c.current?.click(),children:[s.jsx("input",{type:"file",multiple:!0,style:{display:"none"},ref:c,onChange:e=>p(e.target.files),"aria-label":"Upload File"}),s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"1.5rem",pointerEvents:"none"},children:i?"Drop It!":"Drop File Here"}),s.jsx("p",{style:{marginTop:"var(--space-md)",color:"#666",pointerEvents:"none"},children:"CLICK IF YOU MUST"})]})}function u(){let{state:e}=(0,a.useApp)();return(0,s.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"UPLOADING..."}),s.jsx("div",{className:"brutal-progress",children:s.jsx("div",{className:"brutal-progress-fill",style:{width:`${e.progress}%`}})}),(0,s.jsxs)("p",{className:"font-bold",style:{fontSize:"3rem",marginTop:"var(--space-md)",lineHeight:"1"},children:[e.progress,"%"]})]})}function m(){let{state:e,reset:t,uploadSuccess:r}=(0,a.useApp)(),{code:o,expiresAt:l,expiryMinutes:i,maxDownloads:c}=e.data||{},[p,u]=(0,n.useState)(""),[m,x]=(0,n.useState)(!1),[f,h]=(0,n.useState)(i||10),[y,g]=(0,n.useState)("Unlimited"===c?"Unlimited":c||"Unlimited");(0,n.useEffect)(()=>{if(!l)return;let e=()=>{let e=l-Date.now();if(e<=0){u("EXPIRED");return}let t=Math.floor(e%6e4/1e3);u(`${Math.floor(e/6e4)}:${t<10?"0":""}${t}`)};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[l]);let v=async t=>{if(o)try{let s=await d(o,t);r({...e.data,...s}),t.expiryMinutes&&h(t.expiryMinutes),void 0!==t.maxDownloads&&g(t.maxDownloads===1/0?"Unlimited":t.maxDownloads)}catch(e){console.error("Failed to update metadata",e),alert("Failed to update settings")}};return(0,s.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"YOUR CODE"}),s.jsx("div",{className:"brutal-code",children:o}),s.jsx("div",{style:{marginTop:"var(--space-lg)"},children:s.jsx("button",{className:"brutal-button",onClick:()=>{o&&(navigator.clipboard.writeText(o),x(!0),setTimeout(()=>x(!1),2e3))},style:{minWidth:"200px"},children:m?"COPIED!":"COPY CODE"})}),(0,s.jsxs)("div",{style:{marginTop:"var(--space-xl)",display:"flex",flexDirection:"column",gap:"var(--space-lg)",alignItems:"center"},children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"0.9rem",marginBottom:"var(--space-sm)"},children:"EXPIRES IN"}),s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[5,10,30].map(e=>(0,s.jsxs)("button",{onClick:()=>v({expiryMinutes:e}),style:{padding:"var(--space-xs) var(--space-md)",border:"2px solid black",fontWeight:"bold",backgroundColor:f===e?"var(--color-bg-accent)":"transparent",cursor:"pointer"},children:[e,"M"]},e))})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"0.9rem",marginBottom:"var(--space-sm)"},children:"MAX DOWNLOADS"}),s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[1,3,"Unlimited"].map(e=>s.jsx("button",{onClick:()=>v({maxDownloads:"Unlimited"===e?"Infinity":e}),style:{padding:"var(--space-xs) var(--space-md)",border:"2px solid black",fontWeight:"bold",backgroundColor:y===e?"var(--color-bg-accent)":"transparent",cursor:"pointer"},children:"Unlimited"===e?"âˆž":e},e))})]})]}),(0,s.jsxs)("p",{className:"font-bold",style:{marginTop:"var(--space-xl)",fontSize:"1.2rem"},children:["EXPIRES IN: ",s.jsx("span",{style:{color:"var(--color-accent-red)"},children:p})]}),s.jsx("p",{style:{marginTop:"var(--space-lg)",textDecoration:"underline",cursor:"pointer",opacity:.7},onClick:t,children:"SEND ANOTHER FILE"})]})}function x(){let{fetchFileStart:e,fetchFileSuccess:t,fetchFileError:r}=(0,a.useApp)(),[o,l]=(0,n.useState)(""),[d,c]=(0,n.useState)(!1),p=(0,n.useRef)(null);(0,n.useEffect)(()=>{p.current?.focus()},[]);let u=async s=>{if(s.preventDefault(),o&&!(o.length<5)){c(!0),e();try{let e=await i(o);setTimeout(()=>{t(e)},500)}catch(t){console.error(t);let e=t.error||"File not found";e.includes("not found")&&(e="INVALID CODE"),r(e),c(!1)}}};return(0,s.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"ENTER CODE"}),(0,s.jsxs)("form",{onSubmit:u,children:[s.jsx("input",{ref:p,type:"text",className:"brutal-input",placeholder:"XXXXX",maxLength:10,value:o,onChange:e=>l(e.target.value.toUpperCase()),disabled:d,"aria-label":"Enter download code"}),s.jsx("button",{type:"submit",className:"brutal-button",style:{width:"100%",marginTop:"var(--space-lg)"},disabled:d||o.length<5,children:d?"SEARCHING...":"GET FILE"})]})]})}function f(){let{state:e,reset:t}=(0,a.useApp)(),{code:r,originalName:o,size:l}=e.data||{};return(0,n.useEffect)(()=>{if(r){let e=c(r),t=setTimeout(()=>{window.location.href=e},1e3);return()=>clearTimeout(t)}},[r]),(0,s.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"DOWNLOADING..."}),(0,s.jsxs)("div",{className:"brutal-container",style:{backgroundColor:"var(--color-bg-mint)"},children:[s.jsx("p",{className:"font-bold",style:{fontSize:"1.5rem",wordBreak:"break-all"},children:o}),s.jsx("p",{className:"text-mono",style:{marginTop:"var(--space-sm)"},children:(e=>{if(void 0===e||0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]})(l)})]}),s.jsx("div",{className:"brutal-progress",style:{marginTop:"var(--space-lg)"},children:s.jsx("div",{className:"brutal-progress-fill",style:{width:"100%",animation:"pulse 2s infinite"}})}),s.jsx("button",{className:"brutal-button",onClick:t,style:{marginTop:"var(--space-xl)",width:"100%"},children:"SEND A FILE"})]})}function h(){let{state:e,reset:t}=(0,a.useApp)(),{error:r}=e;return(0,s.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,s.jsxs)("div",{className:"brutal-error brutal-container",style:{marginBottom:"var(--space-lg)"},children:[s.jsx("p",{className:"font-bold uppercase",style:{fontSize:"1.5rem",color:"var(--color-accent-red)"},children:"ERROR"}),s.jsx("p",{style:{marginTop:"var(--space-md)",fontSize:"1.2rem"},children:r||"SOMETHING WENT WRONG"})]}),s.jsx("button",{className:"brutal-button",onClick:t,style:{width:"100%"},children:"TRY AGAIN"})]})}function y(){let{state:e,setMode:t,reset:r}=(0,a.useApp)();return(0,s.jsxs)("div",{className:"full-screen",children:[s.jsx("div",{style:{position:"absolute",top:"2rem",right:"2rem"},children:s.jsx("button",{className:"brutal-button",style:{padding:"0.5rem 1rem",fontSize:"0.8rem"},onClick:()=>t("UPLOAD"===e.mode?"DOWNLOAD":"UPLOAD"),children:"UPLOAD"===e.mode?"SWITCH TO DOWNLOAD":"SWITCH TO UPLOAD"})}),(0,s.jsxs)("div",{className:"brutal-container",style:{maxWidth:"600px",width:"100%",minHeight:"400px",display:"flex",flexDirection:"column",justifyContent:"center"},children:[s.jsx("h1",{className:"text-center",style:{marginBottom:"var(--space-xl)",cursor:"pointer"},onClick:r,role:"button",tabIndex:0,onKeyDown:e=>("Enter"===e.key||" "===e.key)&&r(),children:"DropCode"}),"IDLE"===e.status&&s.jsx(p,{}),"UPLOADING"===e.status&&s.jsx(u,{}),"GENERATED"===e.status&&s.jsx(m,{}),"DOWNLOAD_ENTRY"===e.status&&s.jsx(x,{}),"DOWNLOADING"===e.status&&s.jsx(f,{}),"ERROR"===e.status&&s.jsx(h,{})]})]})}},3643:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AppProvider:()=>i,useApp:()=>d});var s=r(5344),a=r(3729);let n={status:"IDLE",data:null,error:null,progress:0,mode:"UPLOAD"};function o(e,t){switch(t.type){case"SET_MODE":return{...e,mode:t.payload,status:"UPLOAD"===t.payload?"IDLE":"DOWNLOAD_ENTRY",error:null};case"START_UPLOAD":return{...e,status:"UPLOADING",progress:0,error:null};case"SET_PROGRESS":return{...e,progress:t.payload};case"UPLOAD_SUCCESS":return{...e,status:"GENERATED",data:t.payload,progress:100};case"UPLOAD_ERROR":return{...e,status:"ERROR",error:t.payload,progress:0};case"ENTER_DOWNLOAD":return{...e,status:"DOWNLOAD_ENTRY",error:null,data:null};case"FETCH_FILE_START":return{...e,status:"DOWNLOADING",progress:0,error:null};case"FETCH_FILE_SUCCESS":return{...e,status:"DOWNLOADING",data:t.payload};case"FETCH_FILE_ERROR":return{...e,status:"ERROR",error:t.payload};case"RESET":return{...n,mode:e.mode};default:return e}}let l=(0,a.createContext)(null);function i({children:e}){let[t,r]=(0,a.useReducer)(o,n);return s.jsx(l.Provider,{value:{state:t,setMode:e=>r({type:"SET_MODE",payload:e}),startUpload:()=>r({type:"START_UPLOAD"}),setProgress:e=>r({type:"SET_PROGRESS",payload:e}),uploadSuccess:e=>r({type:"UPLOAD_SUCCESS",payload:e}),uploadError:e=>r({type:"UPLOAD_ERROR",payload:e}),enterDownload:()=>r({type:"ENTER_DOWNLOAD"}),fetchFileStart:()=>r({type:"FETCH_FILE_START"}),fetchFileSuccess:e=>r({type:"FETCH_FILE_SUCCESS",payload:e}),fetchFileError:e=>r({type:"FETCH_FILE_ERROR",payload:e}),reset:()=>r({type:"RESET"})},children:e})}function d(){let e=(0,a.useContext)(l);if(!e)throw Error("useApp must be used within an AppProvider");return e}},2917:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>a});var s=r(5036);r(7272);let a={title:"DropCode",description:"Fast, secure file sharing."};function n({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{children:e})})}},1450:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(5036),a=r(6843);let n=(0,a.createProxy)(String.raw`X:\projects\DropCode\components\providers\AppProvider.tsx`),{__esModule:o,$$typeof:l}=n;n.default;let i=(0,a.createProxy)(String.raw`X:\projects\DropCode\components\providers\AppProvider.tsx#AppProvider`);(0,a.createProxy)(String.raw`X:\projects\DropCode\components\providers\AppProvider.tsx#useApp`);let d=(0,a.createProxy)(String.raw`X:\projects\DropCode\components\MainApp.tsx`),{__esModule:c,$$typeof:p}=d,u=d.default;function m(){return s.jsx(i,{children:s.jsx(u,{})})}},7272:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,356],()=>r(5984));module.exports=s})();