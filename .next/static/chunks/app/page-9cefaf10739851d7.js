(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7855:function(e,t,a){Promise.resolve().then(a.bind(a,4560)),Promise.resolve().then(a.bind(a,7306))},4560:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var r=a(3827),s=a(4090),o=a(7306),l=a(7878);let n=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let a=0;a<6;a++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},i=async(e,t,a)=>{let r=e instanceof FileList?Array.from(e):e,s=n(),o=[],i=0;r.forEach(e=>i+=e.size);for(let e=0;e<r.length;e++){let t=r[e],n="uploads/".concat(s,"/").concat(t.name);try{let e=await (0,l.ws)(n,t,{access:"public",handleUploadUrl:"/api/blob/upload-token",onUploadProgress:e=>{if(a){let t=e.percentage;a(t)}}});o.push({url:e.url,originalName:t.name,size:t.size,mimeType:t.type,pathname:e.pathname}),t.size}catch(e){throw console.error("Failed to upload ".concat(t.name),e),{error:"Upload Failed"}}}try{let e=await fetch("/api/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shareCode:s,files:o,settings:t})});if(!e.ok)throw Error("Metadata registration failed");let a=await e.json();return{code:s,files:o,totalSize:i,expiresAt:a.expiresAt,downloadsLeft:t.maxDownloads}}catch(e){throw console.error(e),{error:"Registration Failed"}}},c=async e=>{let t=await fetch("/api/share/".concat(encodeURIComponent(e))),a=await t.json();if(!t.ok)throw a;return a};function d(){let{state:e,startUpload:t,setProgress:a,uploadSuccess:l,uploadError:n}=(0,o.useApp)(),[c,d]=(0,s.useState)(!1),p=(0,s.useRef)(null),u="READY"===e.status,m=async r=>{if(!r||0===r.length)return;if(!u){alert("Please select Expiry and Download Limit first.");return}let s=0,o=r instanceof FileList?Array.from(r):r;for(let e of o)s+=e.size;if(s>209715200){alert("Total size too large (Max 200MB)");return}t();try{let t={expiryMinutes:e.config.expiry,maxDownloads:e.config.maxDownloads},r=await i(o,t,e=>{a(e)});setTimeout(()=>{l(r)},300)}catch(e){console.error(e),n(e.error||"Upload failed")}};return(0,r.jsxs)("div",{className:"brutal-upload-zone ".concat(c?"dragover":""),style:{opacity:u?1:.5,cursor:u?"pointer":"not-allowed",position:"relative"},onDrop:e=>{e.preventDefault(),d(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&m(e.dataTransfer.files)},onDragOver:e=>{e.preventDefault(),d(!0)},onDragLeave:()=>{d(!1)},onClick:()=>{var e;return u&&(null===(e=p.current)||void 0===e?void 0:e.click())},children:[(0,r.jsx)("input",{type:"file",multiple:!0,style:{display:"none"},ref:p,onChange:e=>m(e.target.files),"aria-label":"Upload File",disabled:!u}),u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.5rem",pointerEvents:"none"},children:c?"Drop It!":"Drop File Here"}),(0,r.jsx)("p",{style:{marginTop:"var(--space-md)",color:"black",pointerEvents:"none",fontWeight:"bold"},children:"CLICK IF YOU MUST"}),(0,r.jsxs)("div",{className:"text-mono",style:{marginTop:"var(--space-lg)",fontSize:"0.8rem",color:"black",pointerEvents:"none"},children:[(0,r.jsx)("p",{children:"MAX 200MB • ENCRYPTED"}),(0,r.jsx)("p",{children:"NO ACCOUNTS • NO LOGS"})]})]}):(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",color:"black"},children:"CONFIGURATION REQUIRED"}),(0,r.jsx)("p",{className:"text-mono",style:{fontSize:"0.9rem",marginTop:"var(--space-sm)"},children:"SELECT EXPIRY & LIMIT ABOVE"})]})]})}function p(){let{state:e}=(0,o.useApp)();return(0,r.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"UPLOADING..."}),(0,r.jsx)("div",{className:"brutal-progress",children:(0,r.jsx)("div",{className:"brutal-progress-fill",style:{width:"".concat(e.progress,"%")}})}),(0,r.jsxs)("p",{className:"font-bold",style:{fontSize:"3rem",marginTop:"var(--space-md)",lineHeight:"1"},children:[e.progress,"%"]})]})}function u(){var e,t;let{state:a,reset:l,uploadSuccess:n}=(0,o.useApp)(),{code:i,expiresAt:c,expiryMinutes:d,maxDownloads:p}=a.data||{},[u,m]=(0,s.useState)(""),[x,f]=(0,s.useState)(!1),[h,y]=(0,s.useState)(d||10),[E,g]=(0,s.useState)("Unlimited"===p?"Unlimited":p||"Unlimited");return(0,s.useEffect)(()=>{if(!c)return;let e=()=>{let e=c-Date.now();if(e<=0){m("EXPIRED");return}let t=Math.floor(e%6e4/1e3);m("".concat(Math.floor(e/6e4),":").concat(t<10?"0":"").concat(t))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[c]),(0,r.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"YOUR CODE"}),(0,r.jsx)("div",{className:"brutal-code",children:i}),(0,r.jsx)("div",{style:{marginTop:"var(--space-lg)"},children:(0,r.jsx)("button",{className:"brutal-button",onClick:()=>{i&&(navigator.clipboard.writeText(i),f(!0),setTimeout(()=>f(!1),2e3))},style:{minWidth:"200px"},children:x?"COPIED!":"COPY CODE"})}),(0,r.jsxs)("div",{className:"brutal-container",style:{marginTop:"var(--space-xl)",width:"100%",textAlign:"left"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"var(--space-md)"},children:[(0,r.jsx)("span",{className:"font-bold",children:"EXPIRES IN:"}),(0,r.jsx)("span",{className:"text-mono",style:{color:"var(--color-accent-red)"},children:u})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{className:"font-bold",children:"DOWNLOADS LEFT:"}),(0,r.jsx)("span",{className:"text-mono",children:p===1/0?"∞":null!==(t=null===(e=a.data)||void 0===e?void 0:e.downloadsLeft)&&void 0!==t?t:p})]})]}),(0,r.jsx)("p",{style:{marginTop:"var(--space-lg)",textDecoration:"underline",cursor:"pointer",opacity:.7},onClick:l,children:"SEND ANOTHER FILE"})]})}function m(){let{fetchFileStart:e,fetchFileSuccess:t,fetchFileError:a}=(0,o.useApp)(),[l,n]=(0,s.useState)(""),[i,d]=(0,s.useState)(!1),p=(0,s.useRef)(null);(0,s.useEffect)(()=>{var e;null===(e=p.current)||void 0===e||e.focus()},[]);let u=async r=>{if(r.preventDefault(),l&&!(l.length<5)){d(!0),e();try{let e=await c(l);setTimeout(()=>{t(e)},500)}catch(t){console.error(t);let e=t.error||"File not found";e.includes("not found")&&(e="INVALID CODE"),a(e),d(!1)}}};return(0,r.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"ENTER CODE"}),(0,r.jsxs)("form",{onSubmit:u,children:[(0,r.jsx)("input",{ref:p,type:"text",className:"brutal-input",placeholder:"XXXXX",maxLength:10,value:l,onChange:e=>n(e.target.value.toUpperCase()),disabled:i,"aria-label":"Enter download code"}),(0,r.jsx)("button",{type:"submit",className:"brutal-button",style:{width:"100%",marginTop:"var(--space-lg)"},disabled:i||l.length<5,children:i?"SEARCHING...":"GET FILE"})]})]})}function x(){let{state:e,reset:t}=(0,o.useApp)(),{code:a,originalName:l,size:n}=e.data||{};return(0,s.useEffect)(()=>{if(a){let e=setTimeout(async()=>{try{let e=await fetch("/api/share/".concat(a,"/download"),{method:"POST"}),t=await e.json();t.url?window.location.href=t.url:console.error("Download failed",t.error)}catch(e){console.error("Download network error")}},1e3);return()=>clearTimeout(e)}},[a]),(0,r.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"DOWNLOADING..."}),(0,r.jsxs)("div",{className:"brutal-container",style:{backgroundColor:"var(--color-bg-mint)"},children:[(0,r.jsx)("p",{className:"font-bold",style:{fontSize:"1.5rem",wordBreak:"break-all"},children:l}),(0,r.jsx)("p",{className:"text-mono",style:{marginTop:"var(--space-sm)"},children:(e=>{if(void 0===e||0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]})(n)})]}),(0,r.jsx)("div",{className:"brutal-progress",style:{marginTop:"var(--space-lg)"},children:(0,r.jsx)("div",{className:"brutal-progress-fill",style:{width:"100%",animation:"pulse 2s infinite"}})}),(0,r.jsx)("button",{className:"brutal-button",onClick:t,style:{marginTop:"var(--space-xl)",width:"100%"},children:"SEND A FILE"})]})}function f(){let{state:e,reset:t}=(0,o.useApp)(),{error:a}=e;return(0,r.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,r.jsxs)("div",{className:"brutal-error brutal-container",style:{marginBottom:"var(--space-lg)"},children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.5rem",color:"var(--color-accent-red)"},children:"ERROR"}),(0,r.jsx)("p",{style:{marginTop:"var(--space-md)",fontSize:"1.2rem"},children:a||"SOMETHING WENT WRONG"})]}),(0,r.jsx)("button",{className:"brutal-button",onClick:t,style:{width:"100%"},children:"TRY AGAIN"})]})}function h(e){let{onComplete:t}=e,[a,o]=(0,s.useState)("DROP");return(0,s.useEffect)(()=>{let e=setTimeout(()=>{o("IMPACT")},600),a=setTimeout(()=>{o("CODE")},650),r=setTimeout(()=>{t&&t()},1800);return()=>{clearTimeout(e),clearTimeout(a),clearTimeout(r)}},[t]),(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-zinc-900 overflow-hidden",children:["DROP"===a&&(0,r.jsx)("div",{className:"absolute w-8 h-8 bg-white animate-drop",style:{top:"50%",left:"50%",marginLeft:"-1rem",marginTop:"-1rem"}}),"IMPACT"===a&&(0,r.jsx)("div",{className:"relative w-20 h-20 flex items-center justify-center",children:[0,45,90,135,180,225,270,315].map((e,t)=>(0,r.jsx)("div",{className:"absolute w-1 h-6 bg-white animate-burst origin-center",style:{transform:"rotate(".concat(e,"deg)"),"--tx":"".concat(80*Math.cos(e*Math.PI/180),"px"),"--ty":"".concat(80*Math.sin(e*Math.PI/180),"px")}},t))}),("IMPACT"===a||"CODE"===a)&&(0,r.jsx)("div",{className:"absolute z-10 flex flex-col items-center ".concat("CODE"===a?"opacity-100":"opacity-0"),children:(0,r.jsx)("h1",{className:"text-6xl font-black text-white tracking-widest animate-code font-mono",style:{textShadow:"0 0 20px rgba(255,255,255,0.2)"},children:"HJ7MC"})})]})}function y(){let{state:e,setExpiry:t,setDownloads:a}=(0,o.useApp)(),{config:s,status:l}=e,n="UPLOADING"===l;return(0,r.jsxs)("div",{style:{marginBottom:"var(--space-xl)",width:"100%"},children:[(0,r.jsxs)("div",{style:{marginBottom:"var(--space-lg)"},children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"0.8rem",marginBottom:"var(--space-sm)"},children:"Expires In (Required)"}),(0,r.jsx)("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[5,10,30].map(e=>(0,r.jsxs)("button",{onClick:()=>!n&&t(e),disabled:n,className:"text-mono",style:{flex:1,padding:"var(--space-sm)",border:"var(--border-thick) solid var(--color-border)",backgroundColor:s.expiry===e?"var(--color-bg-primary)":"var(--color-bg-card)",color:s.expiry===e?"var(--color-text-primary)":"#999",fontWeight:s.expiry===e?800:400,cursor:n?"not-allowed":"pointer",transition:"all 0.1s ease",boxShadow:s.expiry===e?"4px 4px 0 var(--color-border)":"none",transform:s.expiry===e?"translate(-2px, -2px)":"none",opacity:n?.7:1},children:[e,"m"]},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"0.8rem",marginBottom:"var(--space-sm)"},children:"Download Limit (Required)"}),(0,r.jsx)("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[1,3,100].map(e=>(0,r.jsx)("button",{onClick:()=>!n&&a(e),disabled:n,className:"text-mono",style:{flex:1,padding:"var(--space-sm)",border:"var(--border-thick) solid var(--color-border)",backgroundColor:s.maxDownloads===e?"var(--color-bg-primary)":"var(--color-bg-card)",color:s.maxDownloads===e?"var(--color-text-primary)":"#999",fontWeight:s.maxDownloads===e?800:400,cursor:n?"not-allowed":"pointer",transition:"all 0.1s ease",boxShadow:s.maxDownloads===e?"4px 4px 0 var(--color-border)":"none",transform:s.maxDownloads===e?"translate(-2px, -2px)":"none",opacity:n?.7:1},children:100===e?"∞":e},e))})]})]})}function E(){let{state:e,setMode:t,reset:a}=(0,o.useApp)(),[l,n]=(0,s.useState)(!0);return l?(0,r.jsx)(h,{onComplete:()=>n(!1)}):(0,r.jsxs)("div",{className:"full-screen",children:[(0,r.jsx)("div",{style:{position:"absolute",top:"2rem",right:"2rem"},children:(0,r.jsx)("button",{className:"brutal-button",onClick:()=>t("UPLOAD"===e.mode?"DOWNLOAD":"UPLOAD"),children:"UPLOAD"===e.mode?"SWITCH TO DOWNLOAD":"SWITCH TO UPLOAD"})}),(0,r.jsxs)("div",{className:"brutal-container",style:{maxWidth:"600px",width:"100%",minHeight:"400px",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,r.jsx)("h1",{className:"text-center",style:{marginBottom:"var(--space-xl)",cursor:"pointer"},onClick:a,role:"button",tabIndex:0,onKeyDown:e=>("Enter"===e.key||" "===e.key)&&a(),children:"DropCode"}),("IDLE"===e.status||"READY"===e.status)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y,{}),(0,r.jsx)(d,{})]}),"UPLOADING"===e.status&&(0,r.jsx)(p,{}),"GENERATED"===e.status&&(0,r.jsx)(u,{}),"DOWNLOAD_ENTRY"===e.status&&(0,r.jsx)(m,{}),"DOWNLOADING"===e.status&&(0,r.jsx)(x,{}),"ERROR"===e.status&&(0,r.jsx)(f,{})]})]})}},7306:function(e,t,a){"use strict";a.r(t),a.d(t,{AppProvider:function(){return i},useApp:function(){return c}});var r=a(3827),s=a(4090);let o={status:"IDLE",data:null,error:null,progress:0,mode:"UPLOAD",config:{expiry:null,maxDownloads:null}};function l(e,t){switch(t.type){case"SET_MODE":return{...e,mode:t.payload,status:"UPLOAD"===t.payload?"IDLE":"DOWNLOAD_ENTRY",error:null};case"START_UPLOAD":return{...e,status:"UPLOADING",progress:0,error:null};case"SET_PROGRESS":return{...e,progress:t.payload};case"UPLOAD_SUCCESS":return{...e,status:"GENERATED",data:t.payload,progress:100};case"UPLOAD_ERROR":return{...e,status:"ERROR",error:t.payload,progress:0};case"ENTER_DOWNLOAD":return{...e,status:"DOWNLOAD_ENTRY",error:null,data:null};case"FETCH_FILE_START":return{...e,status:"DOWNLOADING",progress:0,error:null};case"FETCH_FILE_SUCCESS":return{...e,status:"DOWNLOADING",data:t.payload};case"FETCH_FILE_ERROR":return{...e,status:"ERROR",error:t.payload};case"RESET":return{...o,mode:e.mode};case"SET_CONFIG_EXPIRY":{let a={...e.config,expiry:t.payload},r=null!==a.expiry&&null!==a.maxDownloads;return{...e,config:a,status:r&&"IDLE"===e.status?"READY":e.status}}case"SET_CONFIG_DOWNLOADS":{let a={...e.config,maxDownloads:t.payload},r=null!==a.expiry&&null!==a.maxDownloads;return{...e,config:a,status:r&&"IDLE"===e.status?"READY":e.status}}default:return e}}let n=(0,s.createContext)(null);function i(e){let{children:t}=e,[a,i]=(0,s.useReducer)(l,o);return(0,r.jsx)(n.Provider,{value:{state:a,setMode:e=>i({type:"SET_MODE",payload:e}),startUpload:()=>i({type:"START_UPLOAD"}),setProgress:e=>i({type:"SET_PROGRESS",payload:e}),uploadSuccess:e=>i({type:"UPLOAD_SUCCESS",payload:e}),uploadError:e=>i({type:"UPLOAD_ERROR",payload:e}),enterDownload:()=>i({type:"ENTER_DOWNLOAD"}),fetchFileStart:()=>i({type:"FETCH_FILE_START"}),fetchFileSuccess:e=>i({type:"FETCH_FILE_SUCCESS",payload:e}),fetchFileError:e=>i({type:"FETCH_FILE_ERROR",payload:e}),reset:()=>i({type:"RESET"}),setExpiry:e=>i({type:"SET_CONFIG_EXPIRY",payload:e}),setDownloads:e=>i({type:"SET_CONFIG_DOWNLOADS",payload:e})},children:t})}function c(){let e=(0,s.useContext)(n);if(!e)throw Error("useApp must be used within an AppProvider");return e}}},function(e){e.O(0,[878,971,69,744],function(){return e(e.s=7855)}),_N_E=e.O()}]);