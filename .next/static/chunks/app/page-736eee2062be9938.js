(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7855:function(e,t,r){Promise.resolve().then(r.bind(r,5307)),Promise.resolve().then(r.bind(r,7306))},5307:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var a=r(3827),s=r(4090),l=r(7306),o=r(7878);let n=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let r=0;r<6;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},i=async(e,t,r)=>{let a=e instanceof FileList?Array.from(e):e,s=n(),l=[],i=0;a.forEach(e=>i+=e.size);for(let e=0;e<a.length;e++){let t=a[e],n="uploads/".concat(s,"/").concat(t.name);try{let e=await (0,o.ws)(n,t,{access:"public",handleUploadUrl:"/api/blob/upload-token",onUploadProgress:e=>{if(r){let t=e.percentage;r(t)}}});l.push({url:e.url,originalName:t.name,size:t.size,mimeType:t.type,pathname:e.pathname}),t.size}catch(e){throw console.error("Failed to upload ".concat(t.name),e),{error:"Upload Failed"}}}try{let e=await fetch("/api/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shareCode:s,files:l,settings:t})});if(!e.ok)throw Error("Metadata registration failed");let r=await e.json();return{code:s,files:l,totalSize:i,expiresAt:r.expiresAt,downloadsLeft:t.maxDownloads}}catch(e){throw console.error(e),{error:"Registration Failed"}}},c=async e=>{let t=await fetch("/api/share/".concat(encodeURIComponent(e))),r=await t.json();if(!t.ok)throw r;return r};function d(){let{state:e,startUpload:t,setProgress:r,uploadSuccess:o,uploadError:n}=(0,l.useApp)(),[c,d]=(0,s.useState)(!1),p=(0,s.useRef)(null),u="READY"===e.status,m=async a=>{if(!a||0===a.length)return;if(!u){alert("Please select Expiry and Download Limit first.");return}let s=0,l=a instanceof FileList?Array.from(a):a;for(let e of l)s+=e.size;if(s>209715200){alert("Total size too large (Max 200MB)");return}t();try{let t={expiryMinutes:e.config.expiry,maxDownloads:e.config.maxDownloads},a=await i(l,t,e=>{r(e)});setTimeout(()=>{o(a)},300)}catch(e){console.error(e),n(e.error||"Upload failed")}};return(0,a.jsxs)("div",{className:"brutal-upload-zone ".concat(c?"dragover":""),style:{opacity:u?1:.5,cursor:u?"pointer":"not-allowed",position:"relative"},onDrop:e=>{e.preventDefault(),d(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&m(e.dataTransfer.files)},onDragOver:e=>{e.preventDefault(),d(!0)},onDragLeave:()=>{d(!1)},onClick:()=>{var e;return u&&(null===(e=p.current)||void 0===e?void 0:e.click())},children:[(0,a.jsx)("input",{type:"file",multiple:!0,style:{display:"none"},ref:p,onChange:e=>m(e.target.files),"aria-label":"Upload File",disabled:!u}),u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.5rem",pointerEvents:"none"},children:c?"Drop It!":"Drop File Here"}),(0,a.jsx)("p",{style:{marginTop:"var(--space-md)",color:"black",pointerEvents:"none",fontWeight:"bold"},children:"CLICK IF YOU MUST"}),(0,a.jsxs)("div",{className:"text-mono",style:{marginTop:"var(--space-lg)",fontSize:"0.8rem",color:"black",pointerEvents:"none"},children:[(0,a.jsx)("p",{children:"MAX 200MB • ENCRYPTED"}),(0,a.jsx)("p",{children:"NO ACCOUNTS • NO LOGS"})]})]}):(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",color:"black"},children:"CONFIGURATION REQUIRED"}),(0,a.jsx)("p",{className:"text-mono",style:{fontSize:"0.9rem",marginTop:"var(--space-sm)"},children:"SELECT EXPIRY & LIMIT ABOVE"})]})]})}function p(){var e,t;let{state:r,reset:o,uploadSuccess:n}=(0,l.useApp)(),{code:i,expiresAt:c,expiryMinutes:d,maxDownloads:p}=r.data||{},[u,m]=(0,s.useState)(""),[x,f]=(0,s.useState)(!1),[h,y]=(0,s.useState)(d||10),[E,v]=(0,s.useState)("Unlimited"===p?"Unlimited":p||"Unlimited");return(0,s.useEffect)(()=>{if(!c)return;let e=()=>{let e=c-Date.now();if(e<=0){m("EXPIRED");return}let t=Math.floor(e%6e4/1e3);m("".concat(Math.floor(e/6e4),":").concat(t<10?"0":"").concat(t))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[c]),(0,a.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"YOUR CODE"}),(0,a.jsx)("div",{className:"brutal-code",children:i}),(0,a.jsx)("div",{style:{marginTop:"var(--space-lg)"},children:(0,a.jsx)("button",{className:"brutal-button",onClick:()=>{i&&(navigator.clipboard.writeText(i),f(!0),setTimeout(()=>f(!1),2e3))},style:{minWidth:"200px"},children:x?"COPIED!":"COPY CODE"})}),(0,a.jsxs)("div",{className:"brutal-container",style:{marginTop:"var(--space-xl)",width:"100%",textAlign:"left"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"var(--space-md)"},children:[(0,a.jsx)("span",{className:"font-bold",children:"EXPIRES IN:"}),(0,a.jsx)("span",{className:"text-mono",style:{color:"var(--color-accent-red)"},children:u})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)("span",{className:"font-bold",children:"DOWNLOADS LEFT:"}),(0,a.jsx)("span",{className:"text-mono",children:p===1/0?"∞":null!==(t=null===(e=r.data)||void 0===e?void 0:e.downloadsLeft)&&void 0!==t?t:p})]})]}),(0,a.jsx)("p",{style:{marginTop:"var(--space-lg)",textDecoration:"underline",cursor:"pointer",opacity:.7},onClick:o,children:"SEND ANOTHER FILE"})]})}function u(){let{fetchFileStart:e,fetchFileSuccess:t,fetchFileError:r}=(0,l.useApp)(),[o,n]=(0,s.useState)(""),[i,d]=(0,s.useState)(!1),p=(0,s.useRef)(null);(0,s.useEffect)(()=>{var e;null===(e=p.current)||void 0===e||e.focus()},[]);let u=async a=>{if(a.preventDefault(),o&&!(o.length<5)){d(!0),e();try{let e=await c(o);setTimeout(()=>{t(e)},500)}catch(t){console.error(t);let e=t.error||"File not found";e.includes("not found")&&(e="INVALID CODE"),r(e),d(!1)}}};return(0,a.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"ENTER CODE"}),(0,a.jsxs)("form",{onSubmit:u,children:[(0,a.jsx)("input",{ref:p,type:"text",className:"brutal-input",placeholder:"XXXXX",maxLength:10,value:o,onChange:e=>n(e.target.value.toUpperCase()),disabled:i,"aria-label":"Enter download code"}),(0,a.jsx)("button",{type:"submit",className:"brutal-button",style:{width:"100%",marginTop:"var(--space-lg)"},disabled:i||o.length<5,children:i?"SEARCHING...":"GET FILE"})]})]})}function m(){let{state:e,reset:t}=(0,l.useApp)(),{code:r,originalName:o,size:n}=e.data||{};return(0,s.useEffect)(()=>{if(r){let e=setTimeout(async()=>{try{let e=await fetch("/api/share/".concat(r,"/download"),{method:"POST"}),t=await e.json();t.url?window.location.href=t.url:console.error("Download failed",t.error)}catch(e){console.error("Download network error")}},1e3);return()=>clearTimeout(e)}},[r]),(0,a.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.2rem",marginBottom:"var(--space-md)"},children:"DOWNLOADING..."}),(0,a.jsxs)("div",{className:"brutal-container",style:{backgroundColor:"var(--color-bg-mint)"},children:[(0,a.jsx)("p",{className:"font-bold",style:{fontSize:"1.5rem",wordBreak:"break-all"},children:o}),(0,a.jsx)("p",{className:"text-mono",style:{marginTop:"var(--space-sm)"},children:(e=>{if(void 0===e||0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]})(n)})]}),(0,a.jsx)("div",{className:"brutal-progress",style:{marginTop:"var(--space-lg)"},children:(0,a.jsx)("div",{className:"brutal-progress-fill",style:{width:"100%",animation:"pulse 2s infinite"}})}),(0,a.jsx)("button",{className:"brutal-button",onClick:t,style:{marginTop:"var(--space-xl)",width:"100%"},children:"SEND A FILE"})]})}function x(){let{state:e,reset:t}=(0,l.useApp)(),{error:r}=e;return(0,a.jsxs)("div",{className:"text-center",style:{width:"100%",padding:"var(--space-lg) 0"},children:[(0,a.jsxs)("div",{className:"brutal-error brutal-container",style:{marginBottom:"var(--space-lg)"},children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"1.5rem",color:"var(--color-accent-red)"},children:"ERROR"}),(0,a.jsx)("p",{style:{marginTop:"var(--space-md)",fontSize:"1.2rem"},children:r||"SOMETHING WENT WRONG"})]}),(0,a.jsx)("button",{className:"brutal-button",onClick:t,style:{width:"100%"},children:"TRY AGAIN"})]})}function f(e){let{onComplete:t,messages:r}=e,[l,o]=(0,s.useState)(0),n=r||["INITIALIZING","LOADING ASSETS","PREPARING DROP"];return(0,s.useEffect)(()=>{let e;let r=setInterval(()=>{o(e=>(e+1)%n.length)},1500);return t&&(e=setTimeout(()=>{t()},2e3)),()=>{clearInterval(r),e&&clearTimeout(e)}},[t,n.length]),(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center overflow-hidden bg-[var(--color-bg-body)]",children:[(0,a.jsxs)("div",{className:"relative w-32 h-32 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute w-full h-full border-black bg-white animate-compress",style:{borderStyle:"solid",boxShadow:"8px 8px 0 rgba(0,0,0,0.1)"}}),(0,a.jsx)("div",{className:"absolute z-10 w-12 h-12 bg-black animate-lock"})]}),(0,a.jsx)("div",{className:"mt-12 h-8 flex items-center justify-center",children:(0,a.jsx)("p",{className:"font-bold font-mono text-xl tracking-widest uppercase",children:n[l]})}),(0,a.jsx)("div",{className:"mt-2 opacity-50 font-mono text-xs uppercase",children:"DropCode v2.0"})]})}function h(){let{state:e,setExpiry:t,setDownloads:r}=(0,l.useApp)(),{config:s,status:o}=e,n="UPLOADING"===o;return(0,a.jsxs)("div",{style:{marginBottom:"var(--space-xl)",width:"100%"},children:[(0,a.jsxs)("div",{style:{marginBottom:"var(--space-lg)"},children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"0.8rem",marginBottom:"var(--space-sm)"},children:"Expires In (Required)"}),(0,a.jsx)("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[5,10,30].map(e=>(0,a.jsxs)("button",{onClick:()=>!n&&t(e),disabled:n,className:"text-mono",style:{flex:1,padding:"var(--space-sm)",border:"var(--border-thick) solid var(--color-border)",backgroundColor:s.expiry===e?"var(--color-bg-primary)":"var(--color-bg-card)",color:s.expiry===e?"var(--color-text-primary)":"#999",fontWeight:s.expiry===e?800:400,cursor:n?"not-allowed":"pointer",transition:"all 0.1s ease",boxShadow:s.expiry===e?"4px 4px 0 var(--color-border)":"none",transform:s.expiry===e?"translate(-2px, -2px)":"none",opacity:n?.7:1},children:[e,"m"]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold uppercase",style:{fontSize:"0.8rem",marginBottom:"var(--space-sm)"},children:"Download Limit (Required)"}),(0,a.jsx)("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[1,3,100].map(e=>(0,a.jsx)("button",{onClick:()=>!n&&r(e),disabled:n,className:"text-mono",style:{flex:1,padding:"var(--space-sm)",border:"var(--border-thick) solid var(--color-border)",backgroundColor:s.maxDownloads===e?"var(--color-bg-primary)":"var(--color-bg-card)",color:s.maxDownloads===e?"var(--color-text-primary)":"#999",fontWeight:s.maxDownloads===e?800:400,cursor:n?"not-allowed":"pointer",transition:"all 0.1s ease",boxShadow:s.maxDownloads===e?"4px 4px 0 var(--color-border)":"none",transform:s.maxDownloads===e?"translate(-2px, -2px)":"none",opacity:n?.7:1},children:100===e?"∞":e},e))})]})]})}function y(){let{state:e,setMode:t,reset:r}=(0,l.useApp)(),[o,n]=(0,s.useState)(!0);return o?(0,a.jsx)(f,{onComplete:()=>n(!1)}):(0,a.jsxs)("div",{className:"full-screen",children:[(0,a.jsx)("div",{style:{position:"absolute",top:"2rem",right:"2rem"},children:(0,a.jsx)("button",{className:"brutal-button",onClick:()=>t("UPLOAD"===e.mode?"DOWNLOAD":"UPLOAD"),children:"UPLOAD"===e.mode?"SWITCH TO DOWNLOAD":"SWITCH TO UPLOAD"})}),(0,a.jsxs)("div",{className:"brutal-container",style:{maxWidth:"600px",width:"100%",minHeight:"400px",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,a.jsx)("h1",{className:"text-center",style:{marginBottom:"var(--space-xl)",cursor:"pointer"},onClick:r,role:"button",tabIndex:0,onKeyDown:e=>("Enter"===e.key||" "===e.key)&&r(),children:"DropCode"}),("IDLE"===e.status||"READY"===e.status)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h,{}),(0,a.jsx)(d,{})]}),"UPLOADING"===e.status&&(0,a.jsx)(f,{messages:["SEALING FILE","BURNING LINK","SETTING EXPIRY","DO NOT REFRESH","(YOU WILL ANYWAY)"]}),"GENERATED"===e.status&&(0,a.jsx)(p,{}),"DOWNLOAD_ENTRY"===e.status&&(0,a.jsx)(u,{}),"DOWNLOADING"===e.status&&(0,a.jsx)(m,{}),"ERROR"===e.status&&(0,a.jsx)(x,{})]})]})}},7306:function(e,t,r){"use strict";r.r(t),r.d(t,{AppProvider:function(){return i},useApp:function(){return c}});var a=r(3827),s=r(4090);let l={status:"IDLE",data:null,error:null,progress:0,mode:"UPLOAD",config:{expiry:null,maxDownloads:null}};function o(e,t){switch(t.type){case"SET_MODE":return{...e,mode:t.payload,status:"UPLOAD"===t.payload?"IDLE":"DOWNLOAD_ENTRY",error:null};case"START_UPLOAD":return{...e,status:"UPLOADING",progress:0,error:null};case"SET_PROGRESS":return{...e,progress:t.payload};case"UPLOAD_SUCCESS":return{...e,status:"GENERATED",data:t.payload,progress:100};case"UPLOAD_ERROR":return{...e,status:"ERROR",error:t.payload,progress:0};case"ENTER_DOWNLOAD":return{...e,status:"DOWNLOAD_ENTRY",error:null,data:null};case"FETCH_FILE_START":return{...e,status:"DOWNLOADING",progress:0,error:null};case"FETCH_FILE_SUCCESS":return{...e,status:"DOWNLOADING",data:t.payload};case"FETCH_FILE_ERROR":return{...e,status:"ERROR",error:t.payload};case"RESET":return{...l,mode:e.mode};case"SET_CONFIG_EXPIRY":{let r={...e.config,expiry:t.payload},a=null!==r.expiry&&null!==r.maxDownloads;return{...e,config:r,status:a&&"IDLE"===e.status?"READY":e.status}}case"SET_CONFIG_DOWNLOADS":{let r={...e.config,maxDownloads:t.payload},a=null!==r.expiry&&null!==r.maxDownloads;return{...e,config:r,status:a&&"IDLE"===e.status?"READY":e.status}}default:return e}}let n=(0,s.createContext)(null);function i(e){let{children:t}=e,[r,i]=(0,s.useReducer)(o,l);return(0,a.jsx)(n.Provider,{value:{state:r,setMode:e=>i({type:"SET_MODE",payload:e}),startUpload:()=>i({type:"START_UPLOAD"}),setProgress:e=>i({type:"SET_PROGRESS",payload:e}),uploadSuccess:e=>i({type:"UPLOAD_SUCCESS",payload:e}),uploadError:e=>i({type:"UPLOAD_ERROR",payload:e}),enterDownload:()=>i({type:"ENTER_DOWNLOAD"}),fetchFileStart:()=>i({type:"FETCH_FILE_START"}),fetchFileSuccess:e=>i({type:"FETCH_FILE_SUCCESS",payload:e}),fetchFileError:e=>i({type:"FETCH_FILE_ERROR",payload:e}),reset:()=>i({type:"RESET"}),setExpiry:e=>i({type:"SET_CONFIG_EXPIRY",payload:e}),setDownloads:e=>i({type:"SET_CONFIG_DOWNLOADS",payload:e})},children:t})}function c(){let e=(0,s.useContext)(n);if(!e)throw Error("useApp must be used within an AppProvider");return e}}},function(e){e.O(0,[878,971,69,744],function(){return e(e.s=7855)}),_N_E=e.O()}]);